<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoGarden Care</title>
    <meta name="description" content="AI-assisted plant care for Indian seasons with a searchable database, editable calendar, and visual troubleshooting.">
    
    <!-- SEO & Social Media Tags -->
    <meta property="og:title" content="EcoGarden Care">
    <meta property="og:description" content="Your all-in-one guide to a thriving garden, enhanced with AI.">
    <meta property="og:image" content="https://placehold.co/1200x630/6B8A7A/FFFFFF?text=EcoGarden%0ACare">
    <meta property="og:url" content="https://devx-amaan0-1.github.io/">
    <meta name="twitter:card" content="summary_large_image">

    <!-- PWA & Favicon -->
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="https://placehold.co/32x32/6B8A7A/FFFFFF?text=ðŸŒ±" type="image/png">
    <link rel="apple-touch-icon" href="https://placehold.co/180x180/6B8A7A/FFFFFF?text=ðŸŒ±">
    <meta name="theme-color" content="#F8F7F4">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --sage:#6B8A7A; --ink:#3D403D; --bg:#F8F7F4; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg); color: var(--ink); }
        .nav-button.active { background-color: var(--sage); color: #fff; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.35s ease-in-out; }
        .accordion-button.open .accordion-arrow { transform: rotate(180deg); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid var(--sage); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .chat-bubble-user { background-color: #E2E8F0; align-self: flex-end; }
        .chat-bubble-model { background-color: #F1F5F9; align-self: flex-start; }
        .input-icon-wrapper { position: absolute; top: 50%; right: 0.5rem; transform: translateY(-50%); display: flex; flex-direction: column; gap: 0.5rem; }
        .input-icon { cursor: pointer; opacity: 0.7; transition: opacity 0.2s; }
        .input-icon:hover { opacity: 1; }
        .overlay { position: fixed; inset: 0; background-color: rgba(0,0,0,0.5); z-index: 50; display: flex; justify-content: center; align-items: center; }
        .sticky-actions { position: sticky; bottom: 1rem; }
    </style>
</head>
<body class="antialiased">
    <div id="generation-overlay" class="hidden overlay">
        <div class="bg-white p-6 rounded-lg shadow-xl text-center">
            <div class="loader mx-auto mb-4"></div>
            <p class="font-semibold text-lg" id="generation-text">Generating new care guide...</p>
        </div>
    </div>

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-8 relative">
            <h1 class="text-4xl font-bold text-[#3D403D]">EcoGarden Care</h1>
            <p class="mt-2 text-lg text-gray-600">Your all-in-one guide to a thriving garden, enhanced with AI.</p>
            <button id="notification-btn" class="absolute top-0 right-0 p-2 bg-white rounded-full shadow hover:bg-gray-100" title="Enable Care Reminders">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-[var(--sage)]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                </svg>
            </button>
        </header>

        <main>
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
                <div class="flex flex-col sm:flex-row justify-between items-center mb-6">
                    <div class="w-full sm:w-72 mb-4 sm:mb-0 relative">
                        <label for="plant-search" class="block text-sm font-medium text-gray-700 mb-1">Search or Select a Plant:</label>
                        <input type="text" id="plant-search" placeholder="E.g., Rose" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-[#6B8A7A] focus:border-[#6B8A7A]">
                        <div id="plant-search-results" class="absolute z-10 w-full bg-white border border-gray-300 rounded-lg mt-1 max-h-60 overflow-y-auto hidden"></div>
                    </div>
                    <div class="flex space-x-2 p-1 bg-gray-100 rounded-lg">
                        <button id="nav-calendar" class="nav-button active w-full sm:w-auto px-6 py-2 rounded-md font-semibold">Care Calendar</button>
                        <button id="nav-profiles" class="nav-button w-full sm:w-auto px-6 py-2 rounded-md font-semibold">Profiles & Help</button>
                    </div>
                </div>
            </div>

            <div id="view-calendar" class="view-content">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                     <div class="mb-6">
                        <h2 class="text-2xl font-bold text-center text-[#3D403D] mb-2" id="calendar-plant-name"></h2>
                        <p class="text-center text-gray-600 max-w-3xl mx-auto">A 4-week rotational care schedule. Adapt tasks based on the season and always check soil before watering.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8" id="weekly-schedule">
                    </div>
                    <hr class="my-8 border-gray-200">
                    <div>
                        <h3 class="text-2xl font-bold text-center text-[#3D403D] mb-4">Seasonal Care Adjustments</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="seasonal-adjustments">
                        </div>
                    </div>
                     <hr class="my-8 border-gray-200">
                    <div>
                        <h3 class="text-2xl font-bold text-center text-[#3D403D] mb-4">Seasonal Care Intensity Visual</h3>
                         <p class="text-center text-gray-600 mb-4 max-w-3xl mx-auto">This chart visualizes watering frequency changes across seasons. Use it as a quick reference for your routine.</p>
                        <div class="chart-container">
                            <canvas id="seasonalChart"></canvas>
                        </div>
                        <div id="chart-fallback" class="mt-4 text-center text-sm text-gray-600" aria-hidden="true"></div>
                    </div>
                     <hr class="my-8 border-gray-200">
                     <div class="text-center">
                        <h3 class="text-2xl font-bold text-center text-[#3D403D] mb-4">AI-Powered Proactive Tip</h3>
                        <button id="get-proactive-tip" class="bg-[#6B8A7A] text-white font-bold py-2 px-4 rounded-lg hover:bg-[#5a7d6a] transition-colors">âœ¨ Get Proactive Tip</button>
                        <div id="proactive-tip-loader" class="hidden mx-auto mt-4 loader"></div>
                        <div id="proactive-tip-result" class="mt-4 p-4 bg-gray-50 rounded-lg text-left hidden"></div>
                    </div>
                </div>
            </div>

            <div id="view-profiles" class="view-content hidden">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-center text-[#3D403D] mb-2" id="profile-plant-name"></h2>
                        <p class="text-center text-gray-600 max-w-3xl mx-auto" id="profile-intro"></p>
                    </div>
                    <div id="troubleshooting-guide" class="space-y-4">
                    </div>
                    <hr class="my-8 border-gray-200">
                    <div class="text-center">
                        <h3 class="text-2xl font-bold text-center text-[#3D403D] mb-4">AI Plant Doctor</h3>
                        <p class="text-center text-gray-600 mb-4 max-w-3xl mx-auto">Start a conversation with our AI assistant. Describe symptoms, upload a photo, or use your voice.</p>
                        
                        <div id="chat-window" class="mt-4 p-4 bg-gray-50 rounded-lg text-left hidden h-64 overflow-y-auto flex flex-col space-y-2"></div>
                        
                        <div class="relative mt-4">
                            <textarea id="symptom-input" class="w-full p-3 pr-20 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-[#6B8A7A] focus:border-[#6B8A7A]" rows="2" placeholder="Ask the AI Doctor..."></textarea>
                            <div class="input-icon-wrapper">
                                <label for="image-upload" class="input-icon text-gray-500 hover:text-gray-800">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                                    <input type="file" id="image-upload" class="hidden" accept="image/*">
                                </label>
                                <button id="speech-btn" class="input-icon text-gray-500 hover:text-gray-800">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" /></svg>
                                </button>
                            </div>
                        </div>

                        <div id="image-preview-container" class="mt-2 text-left hidden">
                            <img id="image-preview" class="max-h-24 rounded-lg shadow-md inline-block" src="" alt="Image Preview">
                            <button id="remove-image-btn" class="ml-2 text-xs text-red-600 hover:underline">Remove</button>
                        </div>
                        <button id="ai-diagnosis-btn" class="mt-4 bg-[#6B8A7A] text-white font-bold py-2 px-4 rounded-lg hover:bg-[#5a7d6a] transition-colors">âœ¨ Send to AI Doctor</button>
                        <div id="ai-diagnosis-loader" class="hidden mx-auto mt-4 loader"></div>

                    </div>
                </div>
            </div>
        </main>
    </div>

<script>
    const plantData = {
        "Rose": {
            "intro": "Requires proactive care against fungal diseases, especially black spot during the monsoon.",
            "weekly": [
                { "title": "Week 1", "tasks": "Water at base when dry. Apply bone meal/neem cake. Check for black spot. Deadhead." },
                { "title": "Week 2", "tasks": "Check soil. Apply liquid manure. Monitor for pests. Remove blind shoots." },
                { "title": "Week 3", "tasks": "Water at base. Re-apply slow-release fertilizer. Re-check for fungus. Deadhead." },
                { "title": "Week 4", "tasks": "Check soil. Apply liquid manure. Final pest check. Loosen topsoil." }
            ],
            "seasonal": [
                { "season": "Summer", "care": "Water frequently. Provide afternoon shade. Watch for spider mites." },
                { "season": "Monsoon", "care": "High risk of black spot & dieback. Water only when dry. Use fungicide weekly." },
                { "season": "Winter", "care": "Reduce watering. Hard prune in Oct-Dec for best blooms. Apply manure after pruning." }
            ],
            "chartData": [3, 1, 1],
            "troubleshooting": [
                { "symptom": "Black spots on leaves", "cause": "Fungal disease from wet foliage.", "solution": "Remove infected leaves. Water at the base in the morning. Use preventative fungicide." },
                { "symptom": "Stems dying from tip down", "cause": "Dieback fungus entering pruning cuts.", "solution": "Sterilize shears. Cut to healthy white pith. Seal large cuts with fungicide paste." }
            ]
        },
        "Hibiscus": {
            "intro": "A tropical favorite that needs plenty of sun and nutrients to produce its large, vibrant flowers.",
            "weekly": [
                { "title": "Week 1", "tasks": "Water when top inch is dry. Apply high-potassium fertilizer. Check for mealybugs." },
                { "title": "Week 2", "tasks": "Check soil moisture. Monitor for yellow leaves (often a sign of over/under watering)." },
                { "title": "Week 3", "tasks": "Water as needed. Apply organic compost. Prune lightly to encourage bushiness." },
                { "title": "Week 4", "tasks": "Check soil. Final pest check for aphids on new growth." }
            ],
            "seasonal": [
                { "season": "Summer", "care": "Water frequently. Fertilize regularly for blooms. Needs at least 6 hours of sun." },
                { "season": "Monsoon", "care": "Ensure excellent drainage. Reduce feeding. Watch for fungal leaf spots." },
                { "season": "Winter", "care": "Reduce watering. Protect from frost. May enter dormancy and drop leaves." }
            ],
            "chartData": [3, 2, 1],
            "troubleshooting": [
                { "symptom": "Yellow leaves", "cause": "Overwatering, underwatering, or nutrient deficiency.", "solution": "Check soil moisture first. If watering is correct, apply a balanced fertilizer." },
                { "symptom": "Buds dropping", "cause": "Stress from inconsistent watering, temperature changes, or pests like thrips.", "solution": "Maintain consistent watering. Protect from drafts. Inspect buds for tiny insects." }
            ]
        }
    };

    const allPlantNames = ["Rose", "Hibiscus", "Jasmine (Jasminum sambac)", "Marigold", "Sunflower", "Lotus", "Dahlia", "Chrysanthemum", "Bougainvillea", "Petunia", "Periwinkle", "Ixora", "Gardenia", "Oleander", "Crape Jasmine", "Gulmohar", "Bottlebrush", "Orchid", "Lantana", "Cosmos", "Zinnia", "Tuberose", "Poinsettia", "Anthurium", "Carnation", "Gerbera", "Plumeria", "Portulaca", "Morning Glory", "Bluebell Vine", "Chrysanthemum Daisy", "Calendula", "Butterfly Pea", "Snapdragons", "Tulip", "Lavender", "Gazania", "Verbena", "Foxglove", "Sweet William", "Golden Shower", "Kamini", "Spider Lily", "Canna Lily", "Amaryllis", "Daffodil", "Phlox", "Coreopsis", "Balsam", "Night-flowering Jasmine", "Mango (Mangifera indica)", "Banana (Musa paradisiaca)", "Guava", "Papaya", "Coconut", "Pomegranate", "Grapes", "Orange", "Lemon", "Sweet Lime", "Jackfruit", "Custard Apple", "Apple", "Pear", "Peach", "Plum", "Cherry", "Lychee", "Strawberry", "Kiwi", "Sapota / Chikoo", "Tamarind", "Starfruit", "Dragon Fruit", "Passion Fruit", "Mulberry", "Jamun", "Ber", "Amla", "Fig", "Pineapple", "Watermelon", "Muskmelon", "Blackberry", "Raspberry", "Blueberry", "Olive", "Almond", "Walnut", "Cashew", "Pistachio", "Date Palm", "Avocado", "Mangosteen", "Rambutan", "Persimmon", "Gooseberry", "Cranberry", "Bael", "Karonda", "Hydrangea macrophylla"];

    const plantSearch = document.getElementById('plant-search');
    const plantSearchResults = document.getElementById('plant-search-results');
    const weeklyScheduleDiv = document.getElementById('weekly-schedule');
    const seasonalAdjustmentsDiv = document.getElementById('seasonal-adjustments');
    const troubleshootingGuideDiv = document.getElementById('troubleshooting-guide');
    const calendarPlantName = document.getElementById('calendar-plant-name');
    const profilePlantName = document.getElementById('profile-plant-name');
    const profileIntro = document.getElementById('profile-intro');
    const generationOverlay = document.getElementById('generation-overlay');
    const generationText = document.getElementById('generation-text');
    const chartFallback = document.getElementById('chart-fallback');

    const navCalendar = document.getElementById('nav-calendar');
    const navProfiles = document.getElementById('nav-profiles');
    const viewCalendar = document.getElementById('view-calendar');
    const viewProfiles = document.getElementById('view-profiles');

    const getProactiveTipBtn = document.getElementById('get-proactive-tip');
    const proactiveTipLoader = document.getElementById('proactive-tip-loader');
    const proactiveTipResult = document.getElementById('proactive-tip-result');

    const symptomInput = document.getElementById('symptom-input');
    const aiDiagnosisBtn = document.getElementById('ai-diagnosis-btn');
    const aiDiagnosisLoader = document.getElementById('ai-diagnosis-loader');
    const chatWindow = document.getElementById('chat-window');

    const imageUpload = document.getElementById('image-upload');
    const imagePreviewContainer = document.getElementById('image-preview-container');
    const imagePreview = document.getElementById('image-preview');
    const removeImageBtn = document.getElementById('remove-image-btn');
    const notificationBtn = document.getElementById('notification-btn');
    const speechBtn = document.getElementById('speech-btn');


    let seasonalChart;
    let uploadedImageData = null;
    let uploadedImageType = null;
    let chatHistory = [];
    let currentPlant = '';

    function displayPlantData(plantName, data) {
        calendarPlantName.textContent = plantName;
        profilePlantName.textContent = plantName;
        profileIntro.textContent = data.intro;

        weeklyScheduleDiv.innerHTML = data.weekly.map(week => `
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
                <h4 class="font-bold text-lg mb-2 text-[#6B8A7A]">${week.title}</h4>
                <p class="text-sm">${week.tasks}</p>
            </div>
        `).join('');

        seasonalAdjustmentsDiv.innerHTML = data.seasonal.map(season => `
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
                <h4 class="font-bold text-lg mb-2 text-amber-700">${season.season}</h4>
                <p class="text-sm">${season.care}</p>
            </div>
        `).join('');

        troubleshootingGuideDiv.innerHTML = data.troubleshooting.map((item) => `
            <div class="border border-gray-200 rounded-lg">
                <button class="accordion-button w-full text-left p-4 flex justify-between items-center bg-gray-50 hover:bg-gray-100 focus:outline-none">
                    <span class="font-semibold">${item.symptom}</span>
                    <span class="accordion-arrow text-xl transform">â†“</span>
                </button>
                <div class="accordion-content bg-white p-4 border-t border-gray-200">
                    <p class="mb-2"><strong>Possible Causes:</strong> ${item.cause}</p>
                    <p><strong>Solution:</strong> ${item.solution}</p>
                </div>
            </div>
        `).join('');

        updateChart(plantName);
        chatHistory = [];
        chatWindow.innerHTML = '';
        chatWindow.classList.add('hidden');
    }
    
    async function updateContent(plantName) {
        currentPlant = plantName;
        localStorage.setItem('lastPlant', plantName);

        if (plantData[plantName]) {
            displayPlantData(plantName, plantData[plantName]);
            return;
        }
        
        alert(`Care guide for "${plantName}" is not available in the built-in database. This feature would require a serverless backend to generate new guides.`);
    }

    function updateChart(plantName) {
        const data = plantData[plantName];
        if (!data || !data.chartData) {
            chartFallback.textContent = 'No chart data available.';
            if(seasonalChart) seasonalChart.destroy();
            return;
        };
        chartFallback.textContent = '';

        const ctx = document.getElementById('seasonalChart').getContext('2d');
        
        if (seasonalChart) {
            seasonalChart.destroy();
        }

        seasonalChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Summer', 'Monsoon', 'Winter'],
                datasets: [{
                    label: 'Care Intensity (Watering)',
                    data: data.chartData,
                    backgroundColor: [
                        'rgba(255, 159, 64, 0.6)',
                        'rgba(54, 162, 235, 0.6)',
                        'rgba(201, 203, 207, 0.6)'
                    ],
                    borderColor: [
                        'rgba(255, 159, 64, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(201, 203, 207, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 4,
                        ticks: {
                            stepSize: 1,
                            callback: function(value) {
                                const labels = ['None', 'Low', 'Medium', 'High'];
                                return labels[value];
                            }
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    }


    plantSearch.addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        plantSearchResults.innerHTML = '';
        if (searchTerm) {
            const filteredPlants = allPlantNames.filter(plant => plant.toLowerCase().includes(searchTerm));
            if (filteredPlants.length > 0) {
                filteredPlants.forEach(plant => {
                    const item = document.createElement('div');
                    item.textContent = plant;
                    item.classList.add('p-2', 'cursor-pointer', 'hover:bg-gray-100');
                    item.onclick = () => {
                        plantSearch.value = plant;
                        plantSearchResults.classList.add('hidden');
                        updateContent(plant);
                    };
                    plantSearchResults.appendChild(item);
                });
                plantSearchResults.classList.remove('hidden');
            } else {
                plantSearchResults.classList.add('hidden');
            }
        } else {
            plantSearchResults.classList.add('hidden');
        }
    });

    plantSearch.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            const searchTerm = e.target.value;
            plantSearchResults.classList.add('hidden');
            updateContent(searchTerm);
        }
    });


    document.addEventListener('click', (e) => {
        if (!plantSearch.contains(e.target)) {
            plantSearchResults.classList.add('hidden');
        }
    });


    navCalendar.addEventListener('click', () => {
        viewCalendar.classList.remove('hidden');
        viewProfiles.classList.add('hidden');
        navCalendar.classList.add('active');
        navProfiles.classList.remove('active');
    });

    navProfiles.addEventListener('click', () => {
        viewCalendar.classList.add('hidden');
        viewProfiles.classList.remove('hidden');
        navCalendar.classList.remove('active');
        navProfiles.classList.add('active');
    });

    troubleshootingGuideDiv.addEventListener('click', function(e) {
        const button = e.target.closest('.accordion-button');
        if (button) {
            button.classList.toggle('open');
            const content = button.nextElementSibling;
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
            }
        }
    });

    notificationBtn.addEventListener('click', () => {
        if (!("Notification" in window)) {
            alert("This browser does not support desktop notification");
        } else if (Notification.permission === "granted") {
            scheduleWeeklyNotification();
            alert("Notifications are already enabled and have been rescheduled!");
        } else if (Notification.permission !== "denied") {
            Notification.requestPermission().then(function (permission) {
                if (permission === "granted") {
                    scheduleWeeklyNotification();
                    alert("Notifications enabled! You'll get your first reminder next week.");
                }
            });
        } else {
            alert("Notifications are disabled. Please enable them in your browser settings.");
        }
    });

    function scheduleWeeklyNotification() {
        const selectedPlant = currentPlant;
        const weekNumber = Math.floor((new Date().getDate() - 1) / 7) + 1;
        const taskData = plantData[selectedPlant]?.weekly[weekNumber - 1];

        if (taskData) {
            const taskSummary = taskData.tasks.replace(/<[^>]*>/g, ' ').replace(/\s\s+/g, ' ').substring(0, 100) + '...';
            const notificationMessage = `Week ${weekNumber} reminder for your ${selectedPlant}: ${taskSummary}`;
            
            new Notification("Plant Care Reminder", {
                body: notificationMessage,
                icon: "https://placehold.co/192x192/6B8A7A/FFFFFF?text=ðŸŒ±"
            });
        }
    }

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    let isRecognizing = false;
    if (SpeechRecognition) {
        const recognition = new SpeechRecognition();
        recognition.continuous = false;
        recognition.lang = 'en-US';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        speechBtn.addEventListener('click', () => {
            if (isRecognizing) return;
            recognition.start();
        });

        recognition.onstart = () => {
            isRecognizing = true;
            speechBtn.classList.add('text-red-500');
        };

        recognition.onresult = (event) => {
            const speechResult = event.results[0][0].transcript;
            symptomInput.value = speechResult;
        };

        recognition.onspeechend = () => {
            recognition.stop();
            isRecognizing = false;
            speechBtn.classList.remove('text-red-500');
        };

        recognition.onerror = (event) => {
            alert(`Speech recognition error: ${event.error}`);
            isRecognizing = false;
            speechBtn.classList.remove('text-red-500');
        };
    } else {
        speechBtn.style.display = 'none';
    }


    document.addEventListener('DOMContentLoaded', () => {
        const lastPlant = localStorage.getItem('lastPlant') || Object.keys(plantData)[0];
        plantSearch.value = lastPlant;
        updateContent(lastPlant);
    });

</script>
</body>
</html>
